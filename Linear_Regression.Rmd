<h1 align='center'>Linear Regression</h1>
Here **mtcars** dataset is using for this topic, which is available in the R.
Let us determine the factors on which the mileage of car depends using multiple linear regression.To know more about the dataset use the code `?mtcars`.\
Here _dplyr_ package is using for easy manipulation of dataset.
```{r message=FALSE, warning=FALSE, paged.print=FALSE, results='hide'}
library(dplyr, warn.conflicts = F)
```
Now import dataset using below code.
```{r}
data("mtcars")
df = mtcars
str(df) # or use glimpse(df)
```
Select only those variables which are continuous in nature.
```{r}
df1 <- select(df,-c(cyl,vs,am,gear,carb))
```
Fit a multiple linear regression model for the above data using _mpg_ as response variable and all other variables as _predictor_ variables.
```{r}
mlr1 <-lm(mpg~.,data = df1)
summary(mlr1)
```
```{r}
par(mfrow=c(2,2))
plot(mlr1)
```
```{r results='hide'}
dev.off() # to reset grephic parameter to default
```
Except _wt_ all others variables have p-value more than 0.05. In Residual vs fitted graph data points are not evenly distributed around zero line. Therefore the model is not a good fit.\
In the model there may be presence of heteroscedacity and multicolinearity.Use **Breusch-Pagan test** and **NCV Test** for cheking heteroscadacity in the model.
```{r}
lmtest::bptest(mlr1)  # Breusch-Pagan test
car::ncvTest(mlr1)    #NCV Test
```
Here the p-value for both the test is more than 0.05, therefore there is no heteroscedacity in the model.\
**VIF** is used to determine the presence of multicolinearity in the data.
```{r}
car::vif(mlr1)
```
from the description of dataset we came to know that _qsec_ and _disp_ are the function of someother variables, it is better to drop those variables from the model
```{r}
mlr2 <-update(mlr1,~.-qsec-disp)
summary(mlr2)
```
Above result shows _drat_ is insignificant in the model because it has p-value more than 0.05. Now the updated model is given by,
```{r}
mlr3 <- update(mlr2,~.-drat)
summary(mlr3)
```

The model is given by $mpg = 37.22727-0.03177*hp-3.87783*wt$\
The occuracy of the model is 81.48%.
 \
 \
 \
